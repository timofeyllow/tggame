<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∫—Ä–æ—Å—Å–≤–æ—Ä–¥</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 1000px;
            overflow: hidden;
        }
        
        .screen {
            padding: 30px;
            display: none;
        }
        
        .active {
            display: block;
        }
        
        h1 {
            color: #2e7d32;
            text-align: center;
            margin-bottom: 20px;
            font-size: 28px;
        }
        
        h2 {
            color: #388e3c;
            margin-bottom: 15px;
            font-size: 22px;
        }
        
        p {
            color: #555;
            line-height: 1.5;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .crowns {
            display: flex;
            gap: 10px;
        }
        
        .crown {
            font-size: 24px;
            color: #ffd700;
            opacity: 0.3;
            transition: opacity 0.3s;
        }
        
        .crown.earned {
            opacity: 1;
        }
        
        .levels {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }
        
        .level-btn {
            background: linear-gradient(to bottom, #4caf50, #388e3c);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 15px 25px;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            min-width: 150px;
            position: relative;
        }
        
        .level-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }
        
        .level-btn:active {
            transform: translateY(1px);
        }
        
        .level-btn.locked {
            background: linear-gradient(to bottom, #bdbdbd, #9e9e9e);
            cursor: not-allowed;
        }
        
        .level-btn.locked:hover {
            transform: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .level-crown {
            position: absolute;
            top: -8px;
            right: -8px;
            font-size: 20px;
            color: #ffd700;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .level-btn.completed .level-crown {
            opacity: 1;
        }
        
        .crossword-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .crossword {
            display: grid;
            grid-template-columns: repeat(11, 1fr);
            gap: 2px;
            margin: 20px 0;
            background-color: #333;
            padding: 5px;
            border-radius: 5px;
        }
        
        .cell {
            width: 35px;
            height: 35px;
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            font-weight: bold;
        }
        
        .cell.filled {
            background-color: #e8f5e9;
        }
        
        .cell input {
            width: 100%;
            height: 100%;
            border: none;
            text-align: center;
            font-size: 16px;
            text-transform: uppercase;
            background: transparent;
            outline: none;
            font-weight: bold;
        }
        
        .cell.incorrect {
            background-color: #ffcdd2;
        }
        
        .cell.correct {
            background-color: #c8e6c9;
        }
        
        .number {
            position: absolute;
            top: 1px;
            left: 2px;
            font-size: 10px;
            color: #2e7d32;
            font-weight: bold;
        }
        
        .game-info {
            display: flex;
            width: 100%;
            gap: 20px;
            margin-top: 20px;
        }
        
        .questions-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .questions {
            background-color: #f1f8e9;
            padding: 15px;
            border-radius: 10px;
            flex: 1;
        }
        
        .questions.horizontal {
            border-left: 4px solid #4caf50;
        }
        
        .questions.vertical {
            border-left: 4px solid #ff9800;
        }
        
        .controls {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .question {
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px dashed #c8e6c9;
        }
        
        .question:last-child {
            border-bottom: none;
        }
        
        .question-number {
            display: inline-block;
            width: 20px;
            height: 20px;
            background-color: #2e7d32;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 20px;
            font-size: 12px;
            margin-right: 8px;
        }
        
        .question.horizontal .question-number {
            background-color: #4caf50;
        }
        
        .question.vertical .question-number {
            background-color: #ff9800;
        }
        
        button {
            background: linear-gradient(to bottom, #4caf50, #388e3c);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        button:hover {
            background: linear-gradient(to bottom, #43a047, #2e7d32);
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        button.secondary {
            background: linear-gradient(to bottom, #ff9800, #f57c00);
        }
        
        button.secondary:hover {
            background: linear-gradient(to bottom, #fb8c00, #e65100);
        }
        
        button.danger {
            background: linear-gradient(to bottom, #f44336, #d32f2f);
        }
        
        button.danger:hover {
            background: linear-gradient(to bottom, #e53935, #c62828);
        }
        
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            font-size: 18px;
        }
        
        .success {
            background-color: #c8e6c9;
            color: #2e7d32;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
        
        .error {
            background-color: #ffcdd2;
            color: #d32f2f;
        }
        
        .hint-used {
            color: #ff9800;
            font-weight: bold;
            margin-top: 10px;
        }
        
        .menu-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        .congratulations {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
            border-radius: 10px;
            margin-top: 20px;
            animation: fadeIn 1s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .congratulations h2 {
            color: #2e7d32;
            margin-bottom: 10px;
        }
        
        .congratulations p {
            font-size: 18px;
            margin-bottom: 15px;
        }
        
        @media (max-width: 768px) {
            .game-info {
                flex-direction: column;
            }
            
            .cell {
                width: 28px;
                height: 28px;
            }
            
            .level-btn {
                min-width: 120px;
                padding: 12px 20px;
            }
            
            .crossword {
                grid-template-columns: repeat(11, 1fr);
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –≠–∫—Ä–∞–Ω –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è -->
        <div id="welcome-screen" class="screen active">
            <div class="header">
                <h1>–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∫—Ä–æ—Å—Å–≤–æ—Ä–¥</h1>
                <div class="crowns">
                    <div class="crown" id="crown-1">üëë</div>
                    <div class="crown" id="crown-2">üëë</div>
                    <div class="crown" id="crown-3">üëë</div>
                    <div class="crown" id="crown-4">üëë</div>
                </div>
            </div>
            <p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è –æ–± —ç–∫–æ–ª–æ–≥–∏–∏ –∏ –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥–µ! –†–∞–∑–≥–∞–¥–∞–π—Ç–µ –∫—Ä–æ—Å—Å–≤–æ—Ä–¥ –∏ —É–∑–Ω–∞–π—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Ñ–∞–∫—Ç—ã –æ –∑–∞—â–∏—Ç–µ –ø—Ä–∏—Ä–æ–¥—ã.</p>
            <div class="levels">
                <button class="level-btn" id="level-1" onclick="showLevel(1)">
                    –£—Ä–æ–≤–µ–Ω—å 1: –ù–∞—á–∞–ª—å–Ω—ã–π
                    <div class="level-crown">üëë</div>
                </button>
                <button class="level-btn locked" id="level-2" onclick="showLockedMessage()">
                    –£—Ä–æ–≤–µ–Ω—å 2: –°—Ä–µ–¥–Ω–∏–π
                    <div class="level-crown">üëë</div>
                </button>
                <button class="level-btn locked" id="level-3" onclick="showLockedMessage()">
                    –£—Ä–æ–≤–µ–Ω—å 3: –°–ª–æ–∂–Ω—ã–π
                    <div class="level-crown">üëë</div>
                </button>
                <button class="level-btn locked" id="level-4" onclick="showLockedMessage()">
                    –£—Ä–æ–≤–µ–Ω—å 4: –≠–∫—Å–ø–µ—Ä—Ç
                    <div class="level-crown">üëë</div>
                </button>
            </div>
        </div>
        
        <!-- –≠–∫—Ä–∞–Ω –∏–≥—Ä—ã -->
        <div id="game-screen" class="screen">
            <div class="header">
                <h1>–£—Ä–æ–≤–µ–Ω—å 1: –≠–∫–æ–ª–æ–≥–∏—è</h1>
                <div class="crowns">
                    <div class="crown" id="game-crown-1">üëë</div>
                    <div class="crown" id="game-crown-2">üëë</div>
                    <div class="crown" id="game-crown-3">üëë</div>
                    <div class="crown" id="game-crown-4">üëë</div>
                </div>
            </div>
            <div class="crossword-container">
                <div class="crossword" id="crossword"></div>
                
                <div class="game-info">
                    <div class="questions-container">
                        <div class="questions horizontal">
                            <h2>üìè –ü–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏:</h2>
                            <div class="question horizontal">
                                <span class="question-number">2</span>
                                –í—Å–µ –∂–∏–≤–æ–µ, —á—Ç–æ –Ω–∞—Å –æ–∫—Ä—É–∂–∞–µ—Ç
                            </div>
                            <div class="question horizontal">
                                <span class="question-number">3</span>
                                –ó–∞—â–∏—Ç–∞ –ø—Ä–∏—Ä–æ–¥—ã –æ—Ç –≤—Ä–µ–¥–Ω–æ–≥–æ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è
                            </div>
                            <div class="question horizontal">
                                <span class="question-number">5</span>
                                –û—Ö—Ä–∞–Ω—è–µ–º–∞—è –ø—Ä–∏—Ä–æ–¥–Ω–∞—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è
                            </div>
                            <div class="question horizontal">
                                <span class="question-number">6</span>
                                –ù–∞—É–∫–∞ –æ –≤–∑–∞–∏–º–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö –æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤ —Å –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥–æ–π
                            </div>
                            <div class="question horizontal">
                                <span class="question-number">7</span>
                                –£—Ö—É–¥—à–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥—ã
                            </div>
                            <div class="question horizontal">
                                <span class="question-number">9</span>
                                –ó–∞–±–æ—Ç–∞ –æ –ø—Ä–∏—Ä–æ–¥–µ
                            </div>
                        </div>
                        
                        <div class="questions vertical">
                            <h2>üìê –ü–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏:</h2>
                            <div class="question vertical">
                                <span class="question-number">1</span>
                                –ú–Ω–æ–≥–æ–ª–µ—Ç–Ω–µ–µ —Ä–∞—Å—Ç–µ–Ω–∏–µ —Å —Ç–≤–µ—Ä–¥—ã–º —Å—Ç–≤–æ–ª–æ–º
                            </div>
                            <div class="question vertical">
                                <span class="question-number">4</span>
                                –û–∫—Ä—É–∂–∞—é—â–∏–π –º–∏—Ä, –ø—Ä–∏—Ä–æ–¥–∞
                            </div>
                            <div class="question vertical">
                                <span class="question-number">8</span>
                                –°–∏—Å—Ç–µ–º–∞ –∂–∏–≤—ã—Ö –æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤
                            </div>
                            <div class="question vertical">
                                <span class="question-number">10</span>
                                –û—Ç—Ö–æ–¥—ã, –º—É—Å–æ—Ä
                            </div>
                            <div class="question vertical">
                                <span class="question-number">11</span>
                                –ì–∞–∑, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è –¥—ã—Ö–∞–Ω–∏—è
                            </div>
                        </div>
                    </div>
                    
                    <div class="controls">
                        <button id="hintBtn" class="secondary">üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
                        <button id="clearBtn" class="danger">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –ø–æ–ª–µ</button>
                        <button id="checkBtn">‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–≤–µ—Ç</button>
                        <div id="hint-used" class="hint-used"></div>
                    </div>
                </div>
                
                <div id="result" class="result"></div>
                <div id="congratulations" class="congratulations" style="display: none;"></div>
                
                <div class="menu-buttons">
                    <button onclick="showWelcomeScreen()">‚Üê –í –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</button>
                    <button id="shareBtn" style="display:none;" class="secondary">üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Telegram Games API -->
    <script src="https://telegram.org/js/games.js"></script>
    
    <script>
        // –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫—Ä–æ—Å—Å–≤–æ—Ä–¥–∞ –ø–æ –æ–±—Ä–∞–∑—Ü—É
        const crosswordData = {
            size: 11,
            words: [
                // –ü–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏
                {
                    id: 1,
                    word: "–î–ï–†–ï–í–û",
                    direction: "vertical",
                    start: { x: 0, y: 0 },
                    clue: "–ú–Ω–æ–≥–æ–ª–µ—Ç–Ω–µ–µ —Ä–∞—Å—Ç–µ–Ω–∏–µ —Å —Ç–≤–µ—Ä–¥—ã–º —Å—Ç–≤–æ–ª–æ–º"
                },
                {
                    id: 4,
                    word: "–°–†–ï–î–ê",
                    direction: "vertical",
                    start: { x: 4, y: 0 },
                    clue: "–û–∫—Ä—É–∂–∞—é—â–∏–π –º–∏—Ä, –ø—Ä–∏—Ä–æ–¥–∞"
                },
                {
                    id: 8,
                    word: "–ë–ò–û–°–§–ï–†–ê",
                    direction: "vertical",
                    start: { x: 8, y: 0 },
                    clue: "–°–∏—Å—Ç–µ–º–∞ –∂–∏–≤—ã—Ö –æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤"
                },
                {
                    id: 10,
                    word: "–û–¢–•–û–î–´",
                    direction: "vertical",
                    start: { x: 2, y: 5 },
                    clue: "–û—Ç—Ö–æ–¥—ã, –º—É—Å–æ—Ä"
                },
                {
                    id: 11,
                    word: "–í–û–ó–î–£–•",
                    direction: "vertical",
                    start: { x: 10, y: 0 },
                    clue: "–ì–∞–∑, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è –¥—ã—Ö–∞–Ω–∏—è"
                },
                
                // –ü–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏
                {
                    id: 2,
                    word: "–ü–†–ò–†–û–î–ê",
                    direction: "horizontal",
                    start: { x: 0, y: 2 },
                    clue: "–í—Å–µ –∂–∏–≤–æ–µ, —á—Ç–æ –Ω–∞—Å –æ–∫—Ä—É–∂–∞–µ—Ç"
                },
                {
                    id: 3,
                    word: "–û–•–†–ê–ù–ê",
                    direction: "horizontal",
                    start: { x: 0, y: 4 },
                    clue: "–ó–∞—â–∏—Ç–∞ –ø—Ä–∏—Ä–æ–¥—ã –æ—Ç –≤—Ä–µ–¥–Ω–æ–≥–æ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è"
                },
                {
                    id: 5,
                    word: "–ó–ê–ü–û–í–ï–î–ù–ò–ö",
                    direction: "horizontal",
                    start: { x: 0, y: 6 },
                    clue: "–û—Ö—Ä–∞–Ω—è–µ–º–∞—è –ø—Ä–∏—Ä–æ–¥–Ω–∞—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è"
                },
                {
                    id: 6,
                    word: "–≠–ö–û–õ–û–ì–ò–Ø",
                    direction: "horizontal",
                    start: { x: 0, y: 8 },
                    clue: "–ù–∞—É–∫–∞ –æ –≤–∑–∞–∏–º–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö –æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤ —Å –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥–æ–π"
                },
                {
                    id: 7,
                    word: "–ó–ê–ì–†–Ø–ó–ù–ï–ù–ò–ï",
                    direction: "horizontal",
                    start: { x: 0, y: 10 },
                    clue: "–£—Ö—É–¥—à–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥—ã"
                },
                {
                    id: 9,
                    word: "–ó–ê–ë–û–¢–ê",
                    direction: "horizontal",
                    start: { x: 5, y: 3 },
                    clue: "–ó–∞–±–æ—Ç–∞ –æ –ø—Ä–∏—Ä–æ–¥–µ"
                }
            ]
        };

        let hintUsed = false;
        let gameCompleted = false;
        let completedLevels = JSON.parse(localStorage.getItem('completedLevels')) || [];

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–æ–≤
        function showWelcomeScreen() {
            updateCrowns();
            document.getElementById('welcome-screen').classList.add('active');
            document.getElementById('game-screen').classList.remove('active');
        }

        function showLevel(level) {
            document.getElementById('welcome-screen').classList.remove('active');
            document.getElementById('game-screen').classList.add('active');
            
            if (level === 1) {
                createCrossword();
                resetGame();
                updateGameCrowns();
            }
        }

        function showLockedMessage() {
            alert('–≠—Ç–æ—Ç —É—Ä–æ–≤–µ–Ω—å –ø–æ–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–π–¥–∏—Ç–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —É—Ä–æ–≤–Ω–∏!');
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ—Ä–æ–Ω –Ω–∞ –≥–ª–∞–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ
        function updateCrowns() {
            for (let i = 1; i <= 4; i++) {
                const crown = document.getElementById(`crown-${i}`);
                const levelBtn = document.getElementById(`level-${i}`);
                
                if (completedLevels.includes(i)) {
                    crown.classList.add('earned');
                    levelBtn.classList.add('completed');
                    
                    if (i < 4) {
                        document.getElementById(`level-${i+1}`).classList.remove('locked');
                        document.getElementById(`level-${i+1}`).onclick = () => showLevel(i+1);
                    }
                } else {
                    crown.classList.remove('earned');
                    levelBtn.classList.remove('completed');
                }
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ—Ä–æ–Ω –≤ –∏–≥—Ä–µ
        function updateGameCrowns() {
            for (let i = 1; i <= 4; i++) {
                const crown = document.getElementById(`game-crown-${i}`);
                if (completedLevels.includes(i)) {
                    crown.classList.add('earned');
                } else {
                    crown.classList.remove('earned');
                }
            }
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ç–∫–∏ –∫—Ä–æ—Å—Å–≤–æ—Ä–¥–∞
        function createCrossword() {
            const crosswordElement = document.getElementById('crossword');
            crosswordElement.innerHTML = '';
            crosswordElement.style.gridTemplateColumns = `repeat(${crosswordData.size}, 1fr)`;
            
            // –°–æ–∑–¥–∞–µ–º –ø—É—Å—Ç—É—é —Å–µ—Ç–∫—É
            for (let y = 0; y < crosswordData.size; y++) {
                for (let x = 0; x < crosswordData.size; x++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.x = x;
                    cell.dataset.y = y;
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ —ç—Ç–∞ –∫–ª–µ—Ç–∫–∞ –≤ –∫–∞–∫–æ–º-–ª–∏–±–æ —Å–ª–æ–≤–µ
                    const isInWord = crosswordData.words.some(word => {
                        if (word.direction === 'horizontal') {
                            return y === word.start.y && x >= word.start.x && x < word.start.x + word.word.length;
                        } else {
                            return x === word.start.x && y >= word.start.y && y < word.start.y + word.word.length;
                        }
                    });
                    
                    if (isInWord) {
                        cell.classList.add('filled');
                        const input = document.createElement('input');
                        input.type = 'text';
                        input.maxLength = 1;
                        input.dataset.x = x;
                        input.dataset.y = y;
                        
                        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
                        input.addEventListener('input', handleInput);
                        input.addEventListener('keydown', handleKeyDown);
                        input.addEventListener('click', function(e) {
                            e.stopPropagation();
                        });
                        
                        cell.appendChild(input);
                        
                        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ —è—á–µ–π–∫–µ
                        cell.addEventListener('click', function(e) {
                            if (e.target === cell) {
                                input.focus();
                            }
                        });
                    }
                    
                    crosswordElement.appendChild(cell);
                }
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–º–µ—Ä–∞ —Å–ª–æ–≤
            crosswordData.words.forEach(word => {
                const cell = document.querySelector(`.cell[data-x="${word.start.x}"][data-y="${word.start.y}"]`);
                if (cell) {
                    const number = document.createElement('span');
                    number.className = 'number';
                    number.textContent = word.id;
                    cell.appendChild(number);
                }
            });
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞
        function handleInput(e) {
            const input = e.target;
            const value = input.value.toUpperCase();
            const x = parseInt(input.dataset.x);
            const y = parseInt(input.dataset.y);
            
            // –†—É—Å—Å–∫–∏–µ –±—É–∫–≤—ã
            const russianLetters = '–ê–ë–í–ì–î–ï–Å–ñ–ó–ò–ô–ö–õ–ú–ù–û–ü–†–°–¢–£–§–•–¶–ß–®–©–™–´–¨–≠–Æ–Ø';
            
            if (value && !russianLetters.includes(value)) {
                input.value = '';
                return;
            }
            
            input.value = value;
            
            // –ê–≤—Ç–æ–ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–π —è—á–µ–π–∫–µ
            if (value) {
                let nextX = x + 1;
                let nextY = y;
                
                const currentWord = crosswordData.words.find(word => {
                    if (word.direction === 'horizontal') {
                        return y === word.start.y && x >= word.start.x && x < word.start.x + word.word.length - 1;
                    } else {
                        return x === word.start.x && y >= word.start.y && y < word.start.y + word.word.length - 1;
                    }
                });
                
                if (currentWord) {
                    if (currentWord.direction === 'horizontal') {
                        nextX = x + 1;
                        nextY = y;
                    } else {
                        nextX = x;
                        nextY = y + 1;
                    }
                }
                
                focusCell(nextX, nextY);
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à
        function handleKeyDown(e) {
            const input = e.target;
            const x = parseInt(input.dataset.x);
            const y = parseInt(input.dataset.y);
            
            switch(e.key) {
                case 'ArrowRight':
                    e.preventDefault();
                    focusCell(x + 1, y);
                    break;
                case 'ArrowLeft':
                    e.preventDefault();
                    focusCell(x - 1, y);
                    break;
                case 'ArrowDown':
                    e.preventDefault();
                    focusCell(x, y + 1);
                    break;
                case 'ArrowUp':
                    e.preventDefault();
                    focusCell(x, y - 1);
                    break;
                case 'Backspace':
                    if (!input.value) {
                        e.preventDefault();
                        focusCell(x - 1, y);
                    }
                    break;
                case 'Tab':
                    e.preventDefault();
                    focusCell(x + 1, y);
                    break;
            }
        }

        // –§–æ–∫—É—Å –Ω–∞ —è—á–µ–π–∫–µ –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º
        function focusCell(x, y) {
            const cell = document.querySelector(`.cell[data-x="${x}"][data-y="${y}"]`);
            if (cell) {
                const input = cell.querySelector('input');
                if (input) {
                    input.focus();
                }
            }
        }

        // –°–±—Ä–æ—Å –∏–≥—Ä—ã
        function resetGame() {
            hintUsed = false;
            gameCompleted = false;
            document.getElementById('hint-used').textContent = '';
            document.getElementById('result').textContent = '';
            document.getElementById('result').className = 'result';
            document.getElementById('shareBtn').style.display = 'none';
            document.getElementById('congratulations').style.display = 'none';
            
            const inputs = document.querySelectorAll('.cell input');
            inputs.forEach(input => {
                input.value = '';
                input.parentElement.classList.remove('correct', 'incorrect');
            });
        }

        // –ü–æ–¥—Å–∫–∞–∑–∫–∞
        function useHint() {
            if (hintUsed) {
                alert('–í—ã —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –ø–æ–¥—Å–∫–∞–∑–∫—É –Ω–∞ —ç—Ç–æ–º —É—Ä–æ–≤–Ω–µ!');
                return;
            }
            
            const emptyCells = [];
            crosswordData.words.forEach(word => {
                for (let i = 0; i < word.word.length; i++) {
                    let x, y;
                    if (word.direction === 'horizontal') {
                        x = word.start.x + i;
                        y = word.start.y;
                    } else {
                        x = word.start.x;
                        y = word.start.y + i;
                    }
                    
                    const cell = document.querySelector(`.cell[data-x="${x}"][data-y="${y}"] input`);
                    if (cell && !cell.value) {
                        emptyCells.push({cell, letter: word.word[i]});
                    }
                }
            });
            
            if (emptyCells.length === 0) {
                alert('–í—Å–µ —è—á–µ–π–∫–∏ —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã!');
                return;
            }
            
            const randomCell = emptyCells[Math.floor(Math.random() * emptyCells.length)];
            randomCell.cell.value = randomCell.letter;
            
            hintUsed = true;
            document.getElementById('hint-used').textContent = '–ü–æ–¥—Å–∫–∞–∑–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞';
        }

        // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—è
        function clearField() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ø–æ–ª–µ?')) {
                const inputs = document.querySelectorAll('.cell input');
                inputs.forEach(input => {
                    input.value = '';
                    input.parentElement.classList.remove('correct', 'incorrect');
                });
                document.getElementById('result').textContent = '';
                document.getElementById('result').className = 'result';
            }
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤
        function checkAnswers() {
            let allCorrect = true;
            const resultElement = document.getElementById('result');
            const congratulationsElement = document.getElementById('congratulations');
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫–∏
            const cells = document.querySelectorAll('.cell');
            cells.forEach(cell => {
                cell.classList.remove('correct', 'incorrect');
            });
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ
            crosswordData.words.forEach(word => {
                for (let i = 0; i < word.word.length; i++) {
                    let x, y;
                    if (word.direction === 'horizontal') {
                        x = word.start.x + i;
                        y = word.start.y;
                    } else {
                        x = word.start.x;
                        y = word.start.y + i;
                    }
                    
                    const cell = document.querySelector(`.cell[data-x="${x}"][data-y="${y}"]`);
                    const input = cell.querySelector('input');
                    
                    if (input && input.value.toUpperCase() === word.word[i]) {
                        cell.classList.add('correct');
                    } else {
                        cell.classList.add('incorrect');
                        allCorrect = false;
                    }
                }
            });
            
            if (allCorrect) {
                resultElement.textContent = '–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞–∑–≥–∞–¥–∞–ª–∏ –∫—Ä–æ—Å—Å–≤–æ—Ä–¥!';
                resultElement.className = 'result success';
                document.getElementById('shareBtn').style.display = 'inline-block';
                gameCompleted = true;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ
                congratulationsElement.innerHTML = `
                    <h2>üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –¢—ã –º–æ–ª–æ–¥–µ—Ü! üéâ</h2>
                    <p>–¢—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–µ–ª —É—Ä–æ–≤–µ–Ω—å –∏ –ø–æ–∫–∞–∑–∞–ª –æ—Ç–ª–∏—á–Ω—ã–µ –∑–Ω–∞–Ω–∏—è –≤ —ç–∫–æ–ª–æ–≥–∏–∏!</p>
                    <p>–¢–µ–ø–µ—Ä—å —Ç—ã –Ω–∞—Å—Ç–æ—è—â–∏–π –∑–∞—â–∏—Ç–Ω–∏–∫ –ø—Ä–∏—Ä–æ–¥—ã! üå±</p>
                `;
                congratulationsElement.style.display = 'block';
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
                if (!completedLevels.includes(1)) {
                    completedLevels.push(1);
                    localStorage.setItem('completedLevels', JSON.stringify(completedLevels));
                    updateCrowns();
                    
                    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                    setTimeout(() => {
                        showWelcomeScreen();
                    }, 3000);
                }
            } else {
                resultElement.textContent = '–ï—Å—Ç—å –æ—à–∏–±–∫–∏. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –±—É–∫–≤—ã –≤—ã–¥–µ–ª–µ–Ω—ã –∫—Ä–∞—Å–Ω—ã–º.';
                resultElement.className = 'result error';
                congratulationsElement.style.display = 'none';
            }
        }

        // –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º
        function shareScore() {
            if (typeof TelegramGameProxy !== 'undefined') {
                TelegramGameProxy.shareScore();
            } else {
                alert('–§—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –≤ Telegram');
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('hintBtn').addEventListener('click', useHint);
            document.getElementById('clearBtn').addEventListener('click', clearField);
            document.getElementById('checkBtn').addEventListener('click', checkAnswers);
            document.getElementById('shareBtn').addEventListener('click', shareScore);
            
            updateCrowns();
        });
    </script>
</body>
</html>